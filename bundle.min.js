(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)})([function(a,b,c){'use strict';function d(){gapi.load('client:auth2',k.initClient)}var e=Math.abs;Object.defineProperty(b,'__esModule',{value:!0});var f=c(1),g=c.n(f),h={inc:[{description:'Web dev Butcher Project ',value:500,date:'02/01/2018'},{description:'Backend Project for Spotify ',value:2500,date:'02/01/2018'},{description:'Sold U2 ticket ',value:500,date:'02/01/2018'},{description:'Salary ',value:8e3,date:'02/01/2018'},{description:'Freelance toptal VueJS for geolocation ',value:1245.2,date:'02/01/2018'}],exp:[{description:'Daycare',value:2200,date:'02/01/2018'},{description:'Clothes',value:200.21,date:'02/01/2018'},{description:'Bills',value:625,date:'02/01/2018'},{description:'Friday 13 Happy hour',value:125.7,date:'02/01/2018'}]},i=function(){var a=Math.round,b=function(a,b,c,d){this.id=a,this.description=b,this.value=c,this.percentage=-1,this.date=d};b.prototype.calcPercentages=function(b){this.percentage=0<b?a(100*(this.value/b)):-1},b.prototype.getPercentage=function(){return this.percentage};var c=function(a,b,c,d){this.id=a,this.description=b,this.value=c,this.date=d},d={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1},e=function(){d={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1}},f=function(a){var b=0;d.allItems[a].forEach(function(a){b+=a.value}),d.totals[a]=b};return{addItem:function(a,e,f,g){var h,i;return i=0<d.allItems[a].length?d.allItems[a][d.allItems[a].length-1].id+1:0,'exp'===a?h=new b(i,e,f,g):'inc'===a&&(h=new c(i,e,f,g)),d.allItems[a].push(h),h},deleteItem:function(a,b){var c=d.allItems[a].findIndex(function(a){return a.id===b});(null!==c||c!==void 0)&&d.allItems[a].splice(c,1)},calculateBudget:function(){f('inc'),f('exp'),d.budget=d.totals.inc-d.totals.exp,d.percentage=0<d.totals.inc?a(100*(d.totals.exp/d.totals.inc)):-1},calculatePercentages:function(){d.allItems.exp.forEach(function(a){a.calcPercentages(d.totals.inc)})},getPercentages:function(){var a=d.allItems.exp.map(function(a){return a.getPercentage()});return a},loadDataLocalStorage:function(a,b,c){var d;try{var d=JSON.parse(localStorage.getItem(a.key));b(d)}catch(a){c(a)}},getBudget:function(){return{budget:d.budget,percentage:d.percentage,totalInc:d.totals.inc,totalExp:d.totals.exp}},resetInternalData:function(){e()},getAllDataItems:function(){return d.allItems},data2SimpleScheme:function(){return d.allItems},testing:function(){return d}}}(),j=function(){var a={inputType:'.add__type',inputDescription:'.add__description',inputValue:'.add__value',inputBtn:'.add__btn',incomeContainer:'.income__list',expensesContainer:'.expenses__list',budgetLabel:'.budget__value',incomeLabel:'.budget__income--value',expenseLabel:'.budget__expenses--value',percentageLabel:'.budget__expenses--percentage',listItems:'.list-items',expensesPercentages:'.item__percentage',dateLabel:'.budget__title--month',loadBtn:'.load__btn',saveBtn:'.save__btn',chartDiv:'.charts',item:'.item',selectLocalStg:'#selectLocalStg',tabLoad:'.tab-load',okLoadBtn:'.ok-load-btn',loadTabCnt:'#tabLoadContent',localStorageTabContent:'load-local-stg',fileSysTabContent:'#load-file-sys',loadModal:'#loadModal',inputSaveKey:'#inputSaveKey',okSaveBtn:'.ok-save-btn',tabSaveContent:'#tabSaveContent',saveLocalStgTabCnt:'save-local-stg',tabChart:'#tabChart',chartIncTab:'#chart-inc-tab',chartExpTab:'#chart-exp-tab',chartInc:'#chart-inc-content',chartExp:'#chart-exp-content',saveModal:'#saveModal',datePicker:'#datepicker',calendarTabContent:'load-google-cal'},b={incTable:$('#inc-table'),expTable:$('#exp-table'),removeTableRowBtnInc:$('#removeBtn-table-inc'),removeTableRowBtnExp:$('#removeBtn-table-exp'),authGoogle:$('.auth-google'),signoutGoogle:$('.signout-google'),selectCal:$('#selectCal'),datePickerLoad:$('.date-range-load input'),datePickerLoadIni:$('#datePickerLoadIni'),datePickerLoadEnd:$('#datePickerLoadEnd')},c=document.querySelector(a.inputType),d=document.querySelector(a.inputDescription),f=document.querySelector(a.inputValue),g=document.querySelector(a.datePicker),h=function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)},i=function(a){var b=a.map(function(a){return a.description}),c=a.map(function(a){return a.value});return[{type:'pie',values:c,labels:b}]},j=function(a,b){var c;a=e(a),a=a.toFixed(2);var d=a.split('.'),f=d[0],g=d[1];return 3<f.length&&(f=f.substr(0,f.length-3)+','+f.substr(f.length-3,3)),c='exp'===b?'-':'+',c+' '+f+'.'+g},k=function(a){var b=$(a+' div.active'),c=0<b.length?b[0]:b;return c},l=function(a){function b(a){return 10>a?'0'+a:a}var c=new Date(a);return[b(c.getMonth()+1),b(c.getDate()),c.getFullYear()].join('/')},m=function(){var c=l(Date.now());document.getElementById(a.datePicker.slice(1)).value=c,$('#datepicker').datepicker({autoclose:!0}),$('.date-range-load').each(function(){$(this).datepicker('clearDates')}),b.datePickerLoad.each(function(){$(this)[0].value=c})},n=function(a){return'<span style="font-size: 12px;"><em>'+a+'</em></span>'},o=function(){return[{field:'id',title:'',visible:!1},{field:'state',title:'',checkbox:!0},{field:'date',title:'Date',align:'center',class:'col-xs-4',sortable:!0,formatter:n},{field:'description',title:'Description',align:'center',class:'col-xs-4',sortable:!0},{field:'value',title:'Value',align:'center',class:'col-xs-4',sortable:!0}]},p=function(){m(),q()},q=function(){b.incTable.hide(),b.expTable.hide(),b.incTable.bootstrapTable({data:[],columns:o()}),b.expTable.bootstrapTable({data:[],columns:o()})};return{addValueSettings:function(){var a=c.options[c.selectedIndex].value;return{value:parseFloat(f.value),description:d.value,type:a,date:g.value}},addListItem:function(a,c){var d;'inc'===c?d=b.incTable:'exp'===c&&(d=b.expTable),d.bootstrapTable('append',{id:a.id,description:a.description,value:j(a.value,c),date:a.date})},getDOMStrings:function(){return a},getDOMElements:function(){return b},deleteListItem:function(a){document.getElementById(a).remove(),this.alertButton('Item deleted.')},clearFields:function(){var b,c;b=document.querySelectorAll(a.inputDescription+', '+a.inputValue),c=Array.prototype.slice.call(b),c.forEach(function(a){a.value=''}),c[0].focus()},resetAllItems:function(){b.incTable.bootstrapTable('removeAll'),b.expTable.bootstrapTable('removeAll')},displayPercentages:function(b){var c=document.querySelectorAll(a.expensesPercentages);h(c,function(a,c){a.textContent=0<b[c]?b[c]+'%':'---'})},displayBudget:function(b){var c;c='0'<=b.budget?'inc':'exp',document.querySelector(a.budgetLabel).textContent=j(b.budget,c),document.querySelector(a.incomeLabel).textContent=j(b.totalInc,'inc'),document.querySelector(a.expenseLabel).textContent=j(b.totalExp,'exp'),document.querySelector(a.percentageLabel).textContent=0<=b.percentage?b.percentage+'%':'--'},displayMonth:function(){var b=new Date,c=b.getMonth(),d=b.getFullYear();document.querySelector(a.dateLabel).textContent=['January','February','March','April','May','June','July','August','September','October','November','December'][c]+'/'+d},changedType:function(){var b=document.querySelectorAll(a.inputType+','+a.inputDescription+','+a.inputValue);h(b,function(a){a.classList.add('red-focus')}),document.querySelector(a.inputBtn).classList.toggle('red')},generateChart:function(a,b){if(0<a.length){var c=i(a);c[0].textfont={family:'Lato',color:'white',size:14},Plotly.newPlot(b,c,{height:400,width:700,paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',legend:{font:{size:14,color:'white'}},xaxis:{tickcolor:'#fff'}})}else console.log('No data to show in chart.')},getLoadDateRange(){b.datePickerLoad.value;const a=new Date(b.datePickerLoadIni[0].value).toISOString(),c=new Date(b.datePickerLoadEnd[0].value).toISOString();return{initial:a,final:c}},getLoadInfo:function(){var c,d=k(a.loadTabCnt);if(d.id===a.localStorageTabContent){var e=document.querySelector(a.selectLocalStg),f=e.options[e.selectedIndex].value;c={key:f,type:'localStorage'}}else if(d.id===a.calendarTabContent){var g=b.selectCal[0].options[b.selectCal[0].selectedIndex].value;const a=this.getLoadDateRange();c={calendar:g,type:'GCalendar',dateRange:a}}return c},getSaveDataInfo:function(){var b,c=k(a.tabSaveContent);if(c.id===a.saveLocalStgTabCnt){var d=document.querySelector(a.inputSaveKey).value;b={key:d,type:'localStorage'}}return b},helperFillCalendarList:function(a,c){a?c.then(function(a){var c=a.result.items.map(function(a){return{id:a.id,summary:a.summary}});Array.from(b.selectCal[0].options).forEach((a,b)=>{0!=b&&a.remove()}),c.forEach(function(a){b.selectCal[0].options.add(new Option(a.summary,a.id))})}):Array.from(b.selectCal[0].options).forEach((a,b)=>{0!=b&&a.remove()})},alertButton:function(a){$('.myAlert-bottom').show(),$('.myAlert-bottom strong').text(a),setTimeout(function(){$('.myAlert-bottom').hide()},2e3)},onSignInChange:function(a){a?(b.signoutGoogle.show(),b.authGoogle.hide()):(b.signoutGoogle.hide(),b.authGoogle.show())},init:function(){p()}}}(),k=function(){function a(a){var b={inc:[],exp:[]};return a.forEach(function(a){var c=a.summary,d=a.start.dateTime?a.start.dateTime:a.start.date,e=c.split('$'),f=e.slice(0,e.length-1).join().trim(),g=parseFloat(e[e.length-1]),h=0<=g?'inc':'exp';b[h].push({description:f,value:g,date:d})}),b}var b,c=['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],d=document.getElementById('authorize-button'),e=document.getElementById('signout-button');return{init:function(a){b=a},initClient:function(){gapi.client.init({apiKey:'AIzaSyCOEpOC7Tu4j4Xao67GhrLagnJfOAf9hmA',clientId:'292585574072-b8cv3s6m1eqt8iq403r7bl0huvtdaht2.apps.googleusercontent.com',discoveryDocs:c,scope:'https://www.googleapis.com/auth/calendar.readonly'}).then(function(){gapi.auth2.getAuthInstance().isSignedIn.listen(b),b(gapi.auth2.getAuthInstance().isSignedIn.get())})},signOut:function(){gapi.auth2.getAuthInstance().signOut()},signIn:function(){gapi.auth2.getAuthInstance().signIn()},isSignedIn:function(){return gapi.auth2.getAuthInstance().isSignedIn.get()},getListOfCalendarsPromise:function(){var a=gapi.client.calendar.calendarList.list({});return a},obtainDataFromCalendar:function(b,c,d){var e=gapi.client.calendar.events.list({calendarId:b.calendar,timeMin:b.dateRange.initial,timeMax:b.dateRange.final,showDeleted:!1,singleEvents:!0,orderBy:'startTime'});e.then(function(b){var d=b.result.items,e=a(d);c(e)}).catch(function(a){d(a)})}}}(),l=function(a,b,c){function d(a){b.onSignInChange(a);var d=c.getListOfCalendarsPromise();b.helperFillCalendarList(a,d)}var f,g,i=function(){f=b.getDOMStrings(),g=b.getDOMElements(),document.querySelector(f.inputBtn).addEventListener('click',p),document.addEventListener('keypress',function(a){(13===a.keyCode||13===a.which)&&p()}),document.querySelector(f.inputType).addEventListener('change',b.changedType),$(f.tabLoad).on('shown.bs.tab',w),document.querySelector(f.okLoadBtn).addEventListener('click',v),document.querySelector(f.okSaveBtn).addEventListener('click',z),$(f.tabChart).on('shown.bs.tab',A),g.removeTableRowBtnInc.on('click',k),g.removeTableRowBtnExp.on('click',l),g.authGoogle.on('click',c.signIn),g.signoutGoogle.on('click',c.signOut)},k=function(){var c=$.map(g.incTable.bootstrapTable('getSelections'),function(a){return a.id});g.incTable.bootstrapTable('remove',{field:'id',values:c}),c.forEach(function(b){a.deleteItem('inc',b)}),n(),b.alertButton('Item deleted.')},l=function(){var c=$.map(g.expTable.bootstrapTable('getSelections'),function(a){return a.id});g.expTable.bootstrapTable('remove',{field:'id',values:c}),c.forEach(function(b){a.deleteItem('exp',b)}),n(),b.alertButton('Item deleted.')},m=function(a){var b=!0,c=a.description;return(''===c.trim()||void 0===c||null===c)&&(b=!1),(isNaN(a.value)||0>=a.value)&&(b=!1),b},n=function(){a.calculateBudget();var b=a.getBudget();j.displayBudget(b)},o=function(c){if(m(c)){const d=a.addItem(c.type,c.description,c.value,c.date);b.addListItem(d,c.type),b.clearFields(),n(),q()}},p=function(){var a=b.addValueSettings();o(a)},q=function(){a.calculatePercentages();var c=a.getPercentages();b.displayPercentages(c)},r=function(d,e){var f=b.getLoadInfo();'localStorage'===f.type?a.loadDataLocalStorage(f,d,e):'GCalendar'===f.type&&c.obtainDataFromCalendar(f,d,e)},s=function(c){a.resetInternalData(),b.resetAllItems(),g.incTable.show(),g.expTable.show();var d={description:'',value:0,type:'inc'};c.inc.forEach(function(a){d.description=a.description,d.value=a.value,d.date=a.date,o(d)}),d.type='exp',c.exp.forEach(function(a){d.description=a.description,d.value=e(a.value),o(d)})},t=function(a){s(a),$(f.loadModal).modal('hide')},u=function(a){console.log(a),b.alertButton('Error loading.'),$(f.loadModal).modal('hide')},v=function(){r(t,u)},w=function(a){var d,e=a.target;if('nav-tab-load-stg'===e.id){d=document.querySelector(f.selectLocalStg);var g=Object.keys(localStorage),h=d.options.length;if(1<h)for(var j=1;j<h;j++)d.options.remove(1);g.forEach(function(a){d.options.add(new Option(a,a))})}else if('nav-tab-load-cal'===e.id){var i=c.getListOfCalendarsPromise();b.helperFillCalendarList(c.isSignedIn(),i)}},x=function(a,b){localStorage.setItem(b.key,a)},y=function(a,b,c){c(a,b)},z=function(){var c=a.data2SimpleScheme(),d=JSON.stringify(c),e=b.getSaveDataInfo();'localStorage'===e.type?y(d,e,x):console.log('saving error'),$(f.saveModal).modal('hide')},A=function(c){var d,e=c.target,g=a.getAllDataItems();e.id===f.chartIncTab.slice(1)?(d=g.inc,b.generateChart(d,f.chartInc.slice(1))):e.id===f.chartExpTab.slice(1)&&(d=g.exp,b.generateChart(d,f.chartExp.slice(1)))};return{init:function(){console.log('Application has started.'),b.init(),c.init(d),b.displayMonth(),b.displayBudget({budget:0,percentage:0,totalInc:0,totalExp:0}),i();s(h)}}}(i,j,k);l.init(),window.onload=function(){this.onload=function(){},d()},window.onreadystatechange=function(){'complete'===this.readyState&&this.onload()}},function(){(function(a){'use strict';a('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,'')==this.pathname.replace(/^\//,'')&&location.hostname==this.hostname){var b=a(this.hash);if(b=b.length?b:a('[name='+this.hash.slice(1)+']'),b.length)return a('html, body').animate({scrollTop:b.offset().top-48},1e3,'easeInOutExpo'),!1}}),a('.js-scroll-trigger').click(function(){a('.navbar-collapse').collapse('hide')}),a('body').scrollspy({target:'#mainNav',offset:54});var b=function(){100<a('#mainNav').offset().top?a('#mainNav').addClass('navbar-shrink'):a('#mainNav').removeClass('navbar-shrink')};b(),a(window).scroll(b)})(jQuery)}]);